{"ast":null,"code":"import Swal from 'sweetalert2';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/_services/auth.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"src/app/pipes/status-btn.pipe\";\nimport * as i4 from \"src/app/pipes/sort-orders.pipe\";\nimport * as i5 from \"src/app/pipes/filter-orders.pipe\";\n\nfunction OrdersViewComponent_div_15_div_1_button_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 24)(1, \"p\", 25);\n    i0.ɵɵlistener(\"click\", function OrdersViewComponent_div_15_div_1_button_1_Template_p_click_1_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext(3);\n      return ctx_r6.cancelOrder($event);\n    });\n    i0.ɵɵtext(2, \"X\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const order_r1 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"id\", order_r1._id);\n  }\n}\n\nfunction OrdersViewComponent_div_15_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 22);\n    i0.ɵɵtemplate(1, OrdersViewComponent_div_15_div_1_button_1_Template, 3, 1, \"button\", 23);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const order_r1 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", order_r1.status !== \"delivered\" && order_r1.status !== \"canceled\");\n  }\n}\n\nfunction OrdersViewComponent_div_15_p_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"date\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const order_r1 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"Updated at: \", i0.ɵɵpipeBind2(2, 1, order_r1.updatedAt, \"short\"), \"\");\n  }\n}\n\nfunction OrdersViewComponent_div_15_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 26)(1, \"div\", 27);\n    i0.ɵɵelement(2, \"img\", 28);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 29)(4, \"p\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const product_r11 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", product_r11.product.image, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", product_r11.product.name, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Qty: \", product_r11.qty, \" \");\n  }\n}\n\nconst _c0 = function (a0, a1, a2) {\n  return {\n    \"btn-pending\": a0,\n    \"btn-delivering\": a1,\n    \"btn-delivered\": a2\n  };\n};\n\nfunction OrdersViewComponent_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 11);\n    i0.ɵɵtemplate(1, OrdersViewComponent_div_15_div_1_Template, 2, 1, \"div\", 12);\n    i0.ɵɵelementStart(2, \"div\", 13)(3, \"div\", 14)(4, \"h4\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\", 15)(7, \"p\");\n    i0.ɵɵtext(8);\n    i0.ɵɵpipe(9, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(10, OrdersViewComponent_div_15_p_10_Template, 3, 4, \"p\", 16);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(11, \"div\", 17);\n    i0.ɵɵtemplate(12, OrdersViewComponent_div_15_div_12_Template, 8, 3, \"div\", 18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"div\", 19)(14, \"p\", 20);\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(16, \"button\", 21);\n    i0.ɵɵlistener(\"click\", function OrdersViewComponent_div_15_Template_button_click_16_listener($event) {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return ctx_r12.changeStatus($event);\n    });\n    i0.ɵɵtext(17);\n    i0.ɵɵpipe(18, \"titlecase\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const order_r1 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", order_r1.status !== \"delivered\" && order_r1.status !== \"canceled\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\"To: \", order_r1.client, \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"Created at: \", i0.ɵɵpipeBind2(9, 11, order_r1.dateEntry, \"short\"), \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", order_r1.status !== \"pending\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", order_r1.products);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"id\", order_r1._id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"Total price: $\", ctx_r0.getTotalPrice(order_r1._id), \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"value\", order_r1.status);\n    i0.ɵɵpropertyInterpolate(\"id\", order_r1._id);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction3(16, _c0, order_r1.status === \"pending\", order_r1.status === \"ready to serve\", order_r1.status === \"delivered\"));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(18, 14, order_r1.status));\n  }\n}\n\nexport let OrdersViewComponent = /*#__PURE__*/(() => {\n  class OrdersViewComponent {\n    constructor(authService) {\n      this.authService = authService;\n      this.allOrders = [];\n      this.allStatusOrders = [];\n      this.arrOrderByUserId = [];\n    }\n\n    ngOnInit() {\n      this.getOrdersOnTime();\n      this.statusPipe = '';\n    }\n\n    getOrdersOnTime() {\n      this.authService.getOrders().subscribe({\n        next: response => {\n          let meserxId = localStorage.getItem('idUser');\n          this.allOrders = response;\n          this.arrOrderByUserId = this.allOrders.filter(e => {\n            return meserxId === e.userId;\n          });\n          console.log(this.allOrders);\n          this.allStatusOrders = this.arrOrderByUserId;\n        },\n        error: error => {\n          console.error('There was an error!', error);\n        }\n      });\n    }\n\n    changeStatus(e) {\n      const idOrder = e.target.id;\n      console.log(idOrder);\n      const status = e.target.value;\n      console.log(status);\n      let statusOnTime = '';\n\n      switch (status) {\n        case 'ready to serve':\n          statusOnTime = 'delivered';\n          break;\n\n        default:\n          Swal.fire({\n            icon: 'error',\n            title: 'Oops...',\n            text: 'You do not have permission to make this status change!'\n          });\n          break;\n      }\n\n      const objStatus = {\n        status: statusOnTime\n      };\n      this.authService.changeStatusOrder(idOrder, objStatus).subscribe({\n        next: response => {\n          this.getOrdersOnTime();\n        }\n      });\n    }\n\n    changeSectionStatus(e) {\n      let statusSection = e.target.dataset.value;\n      this.statusPipe = statusSection;\n    }\n\n    getTotalPrice(idOfOrder) {\n      let priceOfEachProduct;\n      let arrPrices;\n      this.allStatusOrders.map(e => {\n        if (idOfOrder == e._id) {\n          arrPrices = e.products.map(ee => {\n            priceOfEachProduct = ee.qty * ee.product.price;\n            return priceOfEachProduct;\n          });\n        }\n      });\n      this.totalPrice = arrPrices.reduce((acc, num) => acc + num);\n      return this.totalPrice;\n    }\n\n    cancelOrder(e) {\n      Swal.fire({\n        title: 'Are you sure?',\n        text: \"You won't be able to revert this!\",\n        icon: 'warning',\n        showCancelButton: true,\n        confirmButtonColor: '#30b9d6',\n        cancelButtonColor: '#f35f4c',\n        confirmButtonText: 'Yes, cancel it!'\n      }).then(result => {\n        if (result.isConfirmed) {\n          const idOrder = e.target.id;\n          const objStatus = {\n            status: 'canceled'\n          };\n          this.authService.changeStatusOrder(idOrder, objStatus).subscribe({\n            next: response => {\n              this.getOrdersOnTime();\n            }\n          });\n          Swal.fire('Canceled!', 'The order has been canceled.', 'success');\n        }\n      });\n    }\n\n  }\n\n  OrdersViewComponent.ɵfac = function OrdersViewComponent_Factory(t) {\n    return new (t || OrdersViewComponent)(i0.ɵɵdirectiveInject(i1.AuthService));\n  };\n\n  OrdersViewComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: OrdersViewComponent,\n    selectors: [[\"app-orders-view\"]],\n    decls: 19,\n    vars: 8,\n    consts: [[1, \"container-order-view\"], [1, \"section-orders-container-routing\"], [\"data-value\", \"\", 1, \"nav-btns-menu\", 3, \"click\"], [\"data-value\", \"\", 1, \"nav-menu\"], [\"data-value\", \"pending\", 1, \"nav-menu\"], [\"data-value\", \"delivering\", 1, \"nav-menu\"], [\"data-value\", \"delivered\", 1, \"nav-menu\"], [\"data-value\", \"canceled\", 1, \"nav-menu\"], [1, \"menu-container-routing\"], [1, \"orders-cards-container\"], [\"class\", \"order-card\", 4, \"ngFor\", \"ngForOf\"], [1, \"order-card\"], [\"class\", \"cancel-order\", 4, \"ngIf\"], [1, \"order-info-container\"], [1, \"table-and-client\"], [1, \"time\"], [4, \"ngIf\"], [1, \"products-container\"], [\"class\", \"product-card\", 4, \"ngFor\", \"ngForOf\"], [1, \"totalPrice-container\"], [3, \"id\"], [1, \"btn-status\", 3, \"value\", \"id\", \"ngClass\", \"click\"], [1, \"cancel-order\"], [\"class\", \"btn-cancel-order\", 4, \"ngIf\"], [1, \"btn-cancel-order\"], [1, \"cross-btn\", 3, \"id\", \"click\"], [1, \"product-card\"], [1, \"product-img\"], [3, \"src\"], [1, \"product-info\"]],\n    template: function OrdersViewComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"section\", 1)(2, \"nav\", 2);\n        i0.ɵɵlistener(\"click\", function OrdersViewComponent_Template_nav_click_2_listener($event) {\n          return ctx.changeSectionStatus($event);\n        });\n        i0.ɵɵelementStart(3, \"button\", 3);\n        i0.ɵɵtext(4, \" All \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"button\", 4);\n        i0.ɵɵtext(6, \" Pending \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"button\", 5);\n        i0.ɵɵtext(8, \" Ready to serve \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"button\", 6);\n        i0.ɵɵtext(10, \" Delivered \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"button\", 7);\n        i0.ɵɵtext(12, \" Canceled \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(13, \"div\", 8)(14, \"div\", 9);\n        i0.ɵɵtemplate(15, OrdersViewComponent_div_15_Template, 19, 20, \"div\", 10);\n        i0.ɵɵpipe(16, \"statusBtn\");\n        i0.ɵɵpipe(17, \"sortOrders\");\n        i0.ɵɵpipe(18, \"filterOrders\");\n        i0.ɵɵelementEnd()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(15);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(16, 1, i0.ɵɵpipeBind1(17, 3, i0.ɵɵpipeBind2(18, 5, ctx.arrOrderByUserId, ctx.statusPipe))));\n      }\n    },\n    directives: [i2.NgForOf, i2.NgIf, i2.NgClass],\n    pipes: [i3.StatusBtnPipe, i4.SortOrdersPipe, i5.FilterOrdersPipe, i2.DatePipe, i2.TitleCasePipe],\n    styles: [\".container-order-view[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:100%}.section-orders-container-routing[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:94%;padding:25px;width:100%;row-gap:40px}@media (min-width: 1000px) and (max-width: 1439px){.section-orders-container-routing[_ngcontent-%COMP%]{row-gap:25px}}.nav-btns-menu[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-evenly;align-items:center}.nav-btns-menu[_ngcontent-%COMP%]   .nav-menu[_ngcontent-%COMP%]{text-align:center;text-decoration:none;border:none;border-radius:20px;color:#000;font-weight:700;width:12%;padding:10px;font-size:15px}.nav-btns-menu[_ngcontent-%COMP%]   .nav-menu[_ngcontent-%COMP%]:hover{background-color:#fffcf8;color:#4b9eeb;border:1px solid #4b9eeb}.order-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;background-color:#fff;padding:12px;border-radius:10px;row-gap:15px;justify-content:space-between;align-items:center;box-shadow:2px 2px 2px 1px #0003;font-size:.8rem;font-weight:700;width:22%}@media (min-width: 1000px) and (max-width: 1439px){.order-card[_ngcontent-%COMP%]{row-gap:4px;font-size:.6rem;width:17%}}.order-card[_ngcontent-%COMP%]   .order-info-container[_ngcontent-%COMP%]{display:flex;column-gap:15px;align-items:center}@media (min-width: 1000px) and (max-width: 1439px){.order-card[_ngcontent-%COMP%]   .order-info-container[_ngcontent-%COMP%]{font-size:.75rem}}.order-card[_ngcontent-%COMP%]   .products-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:flex-start;row-gap:25px;column-gap:50%;padding-bottom:10%}@media (min-width: 1000px) and (max-width: 1439px){.order-card[_ngcontent-%COMP%]   .products-container[_ngcontent-%COMP%]{row-gap:14px}}.table-and-client[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:4px}.product-card[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;column-gap:42px;margin-left:7px}.product-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.orders-cards-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-evenly;row-gap:30px;overflow-y:scroll;height:700px;column-gap:65px;padding-bottom:10px}.orders-cards-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:transparent}.orders-cards-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#6b6c6d;border-radius:50px}.orders-cards-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}@media (min-width: 1000px) and (max-width: 1439px){.orders-cards-container[_ngcontent-%COMP%]{height:440px}}@media (min-height: 693px){.orders-cards-container[_ngcontent-%COMP%]{height:460px}}@media (min-height: 730px){.orders-cards-container[_ngcontent-%COMP%]{height:485px}}@media (min-height: 770px){.orders-cards-container[_ngcontent-%COMP%]{height:520px}}@media (min-height: 800px){.orders-cards-container[_ngcontent-%COMP%]{height:565px}}@media (min-height: 840px){.orders-cards-container[_ngcontent-%COMP%]{height:590px}}.product-img[_ngcontent-%COMP%]{width:40px;display:flex;flex-direction:column;align-items:center}.product-img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:40px}@media (min-width: 1000px) and (max-width: 1439px){.product-img[_ngcontent-%COMP%]{height:34px}}.product-info[_ngcontent-%COMP%]{border-bottom:1.7px solid #747373}.time[_ngcontent-%COMP%]{text-align:center;font-weight:700}.btn-status[_ngcontent-%COMP%]{width:40%;border-radius:10px;padding:8px;border:1px solid;font-weight:700;width:47%}.btn-status[_ngcontent-%COMP%]   .btn-style[_ngcontent-%COMP%]{color:#0ff;background-color:#000}.btn-pending[_ngcontent-%COMP%]{background-color:#fff8f8;color:#8b0505}.btn-delivering[_ngcontent-%COMP%]{background-color:#f8fffa;color:#058b53}.btn-delivered[_ngcontent-%COMP%]{background-color:#fbf8ff;color:#38058b;width:47%}.cancel-order[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:flex-end}.btn-cancel-order[_ngcontent-%COMP%]{background-color:red;color:#fff;border:none;width:22px;height:22px;display:flex;border-radius:3px;align-items:center}.cross-btn[_ngcontent-%COMP%]{font-weight:700;margin-left:1px}@media (min-width: 1700px){.orders-cards-container[_ngcontent-%COMP%]{height:680px}}\"]\n  });\n  return OrdersViewComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}